# Schema.org Integration

This document outlines the integration of Schema.org structured data of the Opening Hours Plugin for WordPress.

> Schema.org is a collaborative, community activity with a mission to create, maintain, and promote schemas for structured data on the Internet, on web pages, in email messages, and beyond. â€“ [schema.org](https://schema.org/)

Structured data makes it possible to provide information about venues, people, things and more in a way, that is consumable by machines like search engines. The Opening Hours plugin provides a shortcode and a widget to integrate periods, holidays and irregular openings in the standardized format into a WordPress site. This way, a search engine could automatically extract the opening hours and exceptions from the website and use this information to, say, show the opening status in the search results.

## Produced Schema

The shortcode and widget provide opening hours and exceptions in the form of [JSON-LD](https://www.w3.org/TR/json-ld/) data contained in a `<script>` tag. This means, that the shortcode and widget do not produce content which is visible to users.

The following example shows the output generated by the `[op-schema set_id="sansibar"]` shortcode:

```html
<script type="application/ld+json">
  {
    "@context": [
        "http://schema.org"
    ],
    "@type": "Place",
    "name": "Sansibar",
    "description": "A small bar located in the heart of Berlin"
    "openingHoursSpecification": [
        {
            "@type": "OpeningHoursSpecification",
            "opens": "07:00",
            "closes": "11:00",
            "dayOfWeek": "http://schema.org/Monday"
        },
        {
            "@type": "OpeningHoursSpecification",
            "opens": "12:00",
            "closes": "18:00",
            "dayOfWeek": "http://schema.org/Monday"
        },
        {
            "@type": "OpeningHoursSpecification",
            "opens": "07:00",
            "closes": "11:00",
            "dayOfWeek": "http://schema.org/Tuesday"
        },
        {
            "@type": "OpeningHoursSpecification",
            "opens": "12:00",
            "closes": "18:00",
            "dayOfWeek": "http://schema.org/Tuesday"
        }
    ],
    "specialOpeningHoursSpecification": [
        {
            "@type": "OpeningHoursSpecification",
            "name": "This is a Holiday",
            "validFrom": "2020-01-22",
            "validThrough": "2020-01-26"
        },
        {
            "@type": "OpeningHoursSpecification",
            "name": "This is an Irregular Opening",
            "opens": "09:00",
            "closes": "18:00",
            "validFrom": "2020-02-12",
            "validThrough": "2020-02-12"
        }
    ]
  }
</script>
```

This snippet contains a JSON-LD record describing a place called "Sansibar". Besides the name, the record also contains the following properties:

|Property|Description|
|-----|-----|
|`@type`|Specifies the type of thing being represented in the record. The default is set to [Place](https://schema.org/Place) but can be made more specific through the `schema_attr_type` attribute. For instance a pharmacy can specify the [Pharmacy](https://schema.org/Pharmacy) type. More types can [be found by following the sub types](https://schema.org/Place#subtypes)|
|[`name`](https://schema.org/name)|The name of the place. By default the name of the Set is taken. Can be overriden with `schema_attr_name`|
|[`description`](https://schema.org/description)|A description of the place. By default the description of the Set is taken. Can be overriden with `schema_attr_description`|
|[`openingHoursSpecification`](https://schema.org/openingHoursSpecification)|This property holds a list of regular opening hours (the periods) as single `OpeningHoursSpecification` records. In this example two periods are defined for Mondays and Tuesdays. These entries are generally considered to be recurring. When using child sets, the periods of these will be merged into `openingHoursSpecification` by enhancing the different versions of the opening hours with `validFrom` and `validThrough` entries.|
|[`specialOpeningHoursSpecification`](https://schema.org/specialOpeningHoursSpecification)|This property holds a list of overrides (in the context of the plugin holidays and irregular openings) as `OpeningHoursSpecification` records. In this example a holiday and an irregular opening are given.|

### Extending and modifying the schema

The shortcode and widget provide ways to alter the `@type`, `name` and `description` properties of the JSON-LD record
. Further modifications on the schema record can be performed using the [`op_shortcode_attributes`](filters.md#op_shortcode_attributes) filter. In the following code snippet the record is enhanced with an [address](https://schema.org/address):

```php
use OpeningHours\Module\Shortcode\Schema;

add_filter('op_shortcode_attributes', function (array $attributes, $shortcode) {
    // Only for the op-schema shortcode
    if ($shortcode instanceof Schema) {
        // JSON-LD object is available as associative array under $attributes['schema']
        $attributes['schema']['address'] = array(
            '@type' => 'PostalAddress',
            'addressCountry' => 'DE',
            'addressLocality' => 'Berlin',
            'postalCode' => '10178',
            'streetAddress' => 'Alexanderpl. 1'
        );
    }

    return $attributes;
}, 10, 2);
```